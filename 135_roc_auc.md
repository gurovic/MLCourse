ROC-AUC в машинном обучении  
**Цель:** Оценка качества бинарных классификаторов, особенно при дисбалансе классов.  

---

#### 1. **Основные понятия**
- **ROC-кривая (Receiver Operating Characteristic):**  
  График, показывающий зависимость между:  
  - **TPR (True Positive Rate, чувствительность):**  
    `TPR = TP / (TP + FN)`  
  - **FPR (False Positive Rate):**  
    `FPR = FP / (FP + TN)`  

- **Порог классификации:**  
  Значение от 0 до 1, преобразующее вероятности модели в бинарные метки (например, при пороге 0.5: `prob ≥ 0.5 → класс 1`).  

---

#### 2. **Как строится ROC-кривая?**
1. **Упорядочивание данных:**  
   Объекты сортируются по убыванию предсказанной вероятности принадлежности к классу 1.  
2. **Перебор порогов:**  
   Для каждого уникального значения вероятности (или заданного набора порогов) вычисляются TPR и FPR.  
3. **Построение графика:**  
   Кривая проходит через точки `(FPR, TPR)` для всех порогов.  

**Пример:**  
| Объект | Вероятность класса 1 | Истинный класс | Порог | TP  | FP  | TPR   | FPR   |
|--------|----------------------|----------------|-------|-----|-----|-------|-------|
| A      | 0.9                 | 1              | 0.9   | 1   | 0   | 1.0   | 0.0   |
| B      | 0.8                 | 1              | 0.8   | 2   | 0   | 1.0   | 0.0   |
| C      | 0.7                 | 0              | 0.7   | 2   | 1   | 1.0   | 0.5   |
| D      | 0.6                 | 0              | 0.6   | 2   | 2   | 1.0   | 1.0   |

---

#### 3. **AUC (Area Under Curve)**
- **Определение:**  
  Площадь под ROC-кривой. Значение от 0 до 1.  
- **Интерпретация:**  
  - `AUC = 0.5`: Модель не лучше случайного угадывания.  
  - `AUC = 1.0`: Идеальный классификатор.  
  - `AUC > 0.8`: Хорошее качество модели.  
- **Вероятностный смысл:**  
  AUC равен вероятности, что случайно выбранный **положительный** объект получит более высокий балл, чем случайный **отрицательный**.  

---

#### 4. **Преимущества ROC-AUC**
- **Инвариантность к дисбалансу классов:**  
  Не зависит от соотношения классов (в отличие от accuracy).  
- **Учет ранжирования:**  
  Оценивает способность модели разделять классы на всех порогах.  
- **Порогово-независимая метрика:**  
  Помогает выбрать оптимальный порог классификации.  

---

#### 5. **Сравнение с другими метриками**
| Метрика       | Зависит от порога | Учитывает дисбаланс | Интерпретация площади |
|---------------|-------------------|---------------------|------------------------|
| **ROC-AUC**   | ❌                 | ✅                   | Вероятность ранжирования |
| **Precision-Recall AUC** | ❌ | ✅                   | Только для положительного класса |
| **F1-score**  | ✅                 | ❌                   | Гармоническое среднее |

---

#### 6. **Ограничения**
- **Не учитывает абсолютные значения вероятностей:**  
  Оценивает только ранжирование объектов.  
- **Менее информативна для мультикласса:**  
  Требует модификаций (например, One-vs-Rest).  
- **Чувствительность к шуму:**  
  Выбросы могут искажать форму кривой.  

---

#### 7. **Практические рекомендации**
- **Дисбаланс классов:**  
  Используйте ROC-AUC вместо accuracy.  
- **Выбор порога:**  
  Найдите точку на ROC-кривой, ближайшую к **(0, 1)** (максимум TPR, минимум FPR).  
- **Сравнение моделей:**  
  Модель с бо́льшим AUC лучше разделяет классы.  

---

#### Визуализация    
- **Диагональ (AUC=0.5):** Случайный классификатор.  
- **Левый верхний угол (0, 1):** Идеальная модель.  

---

**Заключение:**  
ROC-AUC — ключевая метрика для задач бинарной классификации, оценивающая качество разделения классов независимо от порога и дисбаланса данных. Она отражает способность модели ранжировать объекты и широко применяется в медицине, финансах, fraud-детекции.
